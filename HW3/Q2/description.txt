The schema of DataFrame is defined by a case class named "Graph" (line 11). The graph is read from the input file, and each line is splitted into separated tokens which are subsequently converted to integers (line 21-22). The created RDD is then implicitly converted to a DataFrame (line 23); and the edges whose weights are less than 5 are filtered (line 24). Two DataFrames are created and then united by row (line 26-27): one contains original "tgt" and "weight" columns; the other one contains original "src" column but the "weight" column is modified by multiplying -1. The united DataFrame is grouped by the node IDs ("tgt" column here) (line 28) and then aggregated based on the sum of weights for each node (line 29). The results are outputted after converting the DataFrame to RDD and inserting tabs into each line (line 32-33).